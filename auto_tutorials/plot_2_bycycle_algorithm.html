<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2. Cycle-by-cycle algorithm &#8212; bycycle 0.1.3 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/logo.jpg"></span>
          bycycle</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="index.html">Tutorial</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="https://github.com/bycycle-tools/bycycle">GitHub</a></li>
            
            
            <li class="dropdown">
              <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown" style="margin-left: 10px">
              v0.1.3
              <span class="caret"></span>
            </button>
              <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                <li><a href="https://bycycle-tools.github.io/bycycle/v1.0.0rc/index.html">v1.0.0 rc</a></li>
                <li><a href="https://bycycle-tools.github.io/bycycle/v0.1.3/index.html">v0.1.3 (stable)</a></li>
              </ul>
            </li>

            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-plot-2-bycycle-algorithm-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="cycle-by-cycle-algorithm">
<span id="sphx-glr-auto-tutorials-plot-2-bycycle-algorithm-py"></span><h1>2. Cycle-by-cycle algorithm<a class="headerlink" href="#cycle-by-cycle-algorithm" title="Permalink to this headline">¶</a></h1>
<p>In the last tutorial notebook, I described the conventional approach for analyzing time-varying
properties of neural oscillations, and in this notebook, we will go over our alternative approach.
The fundamental goal of this approach is to characterize neural oscillations directly in the time
domain. However, this is not straightforward because it attempts to extract the properties of the
oscillatory component, despite the large amount of noise. Specifically, there are two very difficult
problems:</p>
<ol class="arabic simple">
<li><p>What are the features of the oscillation? How do they vary over time?</p></li>
<li><p>During what times is the oscillation present?</p></li>
</ol>
<p>The cycle-by-cycle approach deploys a few strategies to approach these questions. As its name
indicates, this algorithm segments the signal into individual cycles and then analyzes their
features separately from one another. Normally, some preprocessing is recommended to aid in
localizing peaks and troughs (eliminating high frequency power that mostly do not comprise the
oscillator of interest). Additionally, a burst detection approach is applied to define the segments
of the signal to be analyzed for their oscillatory properties.</p>
<p>During this process (as with all data analyses), it is important to be aware if the data is being
processed appropriately. As signal processing is complicated, it is very beneficial to visualize
the measured features along with the raw data to assure they make sense.</p>
<div class="section" id="preprocess-signal">
<h2>0. Preprocess signal<a class="headerlink" href="#preprocess-signal" title="Permalink to this headline">¶</a></h2>
<p>A crucial part of the cycle-by-cycle approach is the ability to localize the peaks and troughs of
the oscillation. Therefore, some preprocessing of the signal is often useful in order to make
these extrema more apparent, i.e. isolate the oscillation component and minimize the
nonoscillatory components. One effective way of doing this is by applying a lowpass filter. The
choice of cutoff frequency is very important. The cutoff frequency should not be low enough in
order to remove high frequency “noise” that interferes with extrema localization but not so low
that it deforms the shape of the oscillation of interest. In order to assess this, the user should
plot the filtered signal in comparison to the original signal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">bycycle.filt</span> <span class="kn">import</span> <span class="n">lowpass_filter</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data/ca1.npy&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span><span class="p">[:</span><span class="mi">125000</span><span class="p">]</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">1250</span>
<span class="n">f_theta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">f_lowpass</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">N_seconds</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>

<span class="c1"># Lowpass filter</span>
<span class="n">signal_low</span> <span class="o">=</span> <span class="n">lowpass_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">f_lowpass</span><span class="p">,</span>
                            <span class="n">N_seconds</span><span class="o">=</span><span class="n">N_seconds</span><span class="p">,</span> <span class="n">remove_edge_artifacts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Plot signal</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span><span class="o">/</span><span class="n">Fs</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">tlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">tidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="n">signal</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="s1">&#39;.5&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tlim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot 2 bycycle algorithm" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_2_bycycle_algorithm_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/tutorials/plot_2_bycycle_algorithm.py:72: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
</div>
<div class="section" id="localize-peaks-and-troughs">
<h2>1. Localize peaks and troughs<a class="headerlink" href="#localize-peaks-and-troughs" title="Permalink to this headline">¶</a></h2>
<p>In order to characterize the oscillation, it is useful to know the precise times of peaks and
troughs. For one, this will allow us to compute the periods and rise-decay symmetries of the
individual cycles. To do this, the signal is first narrow-bandpass filtered in order to estimate
“zero-crossings.” Then, in between these zerocrossings, the absolute maxima and minima are found
and labeled as the peaks and troughs, respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bycycle.filt</span> <span class="kn">import</span> <span class="n">bandpass_filter</span>
<span class="kn">from</span> <span class="nn">bycycle.cyclepoints</span> <span class="kn">import</span> <span class="n">_fzerorise</span><span class="p">,</span> <span class="n">_fzerofall</span><span class="p">,</span> <a href="../generated/bycycle.cyclepoints.find_extrema.html#bycycle.cyclepoints.find_extrema" title="bycycle.cyclepoints.find_extrema" class="sphx-glr-backref-module-bycycle-cyclepoints sphx-glr-backref-type-py-function"><span class="n">find_extrema</span></a>

<span class="c1"># Narrowband filter signal</span>
<span class="n">N_seconds_theta</span> <span class="o">=</span> <span class="o">.</span><span class="mi">75</span>
<span class="n">signal_narrow</span> <span class="o">=</span> <span class="n">bandpass_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">f_theta</span><span class="p">,</span>
                                <span class="n">remove_edge_artifacts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">N_seconds</span><span class="o">=</span><span class="n">N_seconds_theta</span><span class="p">)</span>

<span class="c1"># Find rising and falling zerocrossings (narrowband)</span>
<span class="n">zeroriseN</span> <span class="o">=</span> <span class="n">_fzerorise</span><span class="p">(</span><span class="n">signal_narrow</span><span class="p">)</span>
<span class="n">zerofallN</span> <span class="o">=</span> <span class="n">_fzerofall</span><span class="p">(</span><span class="n">signal_narrow</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find peaks and troughs (this function also does the above)</span>
<span class="n">Ps</span><span class="p">,</span> <span class="n">Ts</span> <span class="o">=</span> <a href="../generated/bycycle.cyclepoints.find_extrema.html#bycycle.cyclepoints.find_extrema" title="bycycle.cyclepoints.find_extrema" class="sphx-glr-backref-module-bycycle-cyclepoints sphx-glr-backref-type-py-function"><span class="n">find_extrema</span></a><span class="p">(</span><span class="n">signal_low</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">f_theta</span><span class="p">,</span>
                      <span class="n">filter_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;N_seconds&#39;</span><span class="p">:</span><span class="n">N_seconds_theta</span><span class="p">})</span>

<span class="n">tlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">tidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">tidxPs</span> <span class="o">=</span> <span class="n">Ps</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">Ps</span><span class="o">&gt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="n">Ps</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">)]</span>
<span class="n">tidxTs</span> <span class="o">=</span> <span class="n">Ts</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">Ts</span><span class="o">&gt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="n">Ts</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidxPs</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidxPs</span><span class="p">],</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidxTs</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidxTs</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tlim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot 2 bycycle algorithm" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_2_bycycle_algorithm_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/tutorials/plot_2_bycycle_algorithm.py:115: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
<div class="section" id="note-the-filter-characteristics-used-in-the-process-of-finding-peaks-and-troughs">
<h3>Note the filter characteristics used in the process of finding peaks and troughs<a class="headerlink" href="#note-the-filter-characteristics-used-in-the-process-of-finding-peaks-and-troughs" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot frequency response of bandpass filter</span>
<span class="kn">from</span> <span class="nn">bycycle.filt</span> <span class="kn">import</span> <span class="n">bandpass_filter</span>
<span class="n">bandpass_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">N_seconds</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span> <span class="n">plot_frequency_response</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Frequency response, Kernel" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_2_bycycle_algorithm_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([nan, nan, nan, ..., nan, nan, nan])
</pre></div>
</div>
</div>
</div>
<div class="section" id="localize-rise-and-decay-midpoints">
<h2>2. Localize rise and decay midpoints<a class="headerlink" href="#localize-rise-and-decay-midpoints" title="Permalink to this headline">¶</a></h2>
<p>In addition to localizing the peaks and troughs of a cycle, we also want to get more information
about the rise and decay periods. For instance, these flanks may have deflections if the peaks or
troughs are particularly sharp. In order to gauge a dimension of this, we localize midpoints for
each of the rise and decay segments. These midpoints are defined as the times at which the voltage
crosses halfway between the adjacent peak and trough voltages. If this threshold is crossed
multiple times, then the median time is chosen as the flank midpoint. This is not perfect;
however, this is rare, and most of these cycles should be removed by burst detection.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bycycle.cyclepoints</span> <span class="kn">import</span> <a href="../generated/bycycle.cyclepoints.find_zerox.html#bycycle.cyclepoints.find_zerox" title="bycycle.cyclepoints.find_zerox" class="sphx-glr-backref-module-bycycle-cyclepoints sphx-glr-backref-type-py-function"><span class="n">find_zerox</span></a>
<span class="n">zeroxR</span><span class="p">,</span> <span class="n">zeroxD</span> <span class="o">=</span> <a href="../generated/bycycle.cyclepoints.find_zerox.html#bycycle.cyclepoints.find_zerox" title="bycycle.cyclepoints.find_zerox" class="sphx-glr-backref-module-bycycle-cyclepoints sphx-glr-backref-type-py-function"><span class="n">find_zerox</span></a><span class="p">(</span><span class="n">signal_low</span><span class="p">,</span> <span class="n">Ps</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">tidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">tidxPs</span> <span class="o">=</span> <span class="n">Ps</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">Ps</span><span class="o">&gt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="n">Ps</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">)]</span>
<span class="n">tidxTs</span> <span class="o">=</span> <span class="n">Ts</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">Ts</span><span class="o">&gt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="n">Ts</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">)]</span>
<span class="n">tidxDs</span> <span class="o">=</span> <span class="n">zeroxD</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">zeroxD</span><span class="o">&gt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="n">zeroxD</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">)]</span>
<span class="n">tidxRs</span> <span class="o">=</span> <span class="n">zeroxR</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">zeroxR</span><span class="o">&gt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">,</span> <span class="n">zeroxR</span><span class="o">&lt;</span><span class="n">tlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidx</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidxPs</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidxPs</span><span class="p">],</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidxTs</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidxTs</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidxDs</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidxDs</span><span class="p">],</span> <span class="s1">&#39;m.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tidxRs</span><span class="p">],</span> <span class="n">signal_low</span><span class="p">[</span><span class="n">tidxRs</span><span class="p">],</span> <span class="s1">&#39;g.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tlim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (seconds)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot 2 bycycle algorithm" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_2_bycycle_algorithm_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/tutorials/plot_2_bycycle_algorithm.py:160: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
</div>
<div class="section" id="compute-features-of-each-cycle">
<h2>3. Compute features of each cycle<a class="headerlink" href="#compute-features-of-each-cycle" title="Permalink to this headline">¶</a></h2>
<p>After these 4 points of each cycle are localized, we compute some simple statistics for each
cycle. The main cycle-by-cycle function,  compute_features(), returns a table (pandas.DataFrame)
in which each entry is a cycle and each column is a property of that cycle (see table below).
There are columns to indicate where in the signal the cycle is located, but the four main features
are:</p>
<ul class="simple">
<li><p>amplitude (volt_amp) - average voltage change of the rise and decay</p></li>
<li><p>period (period) - time between consecutive troughs (or peaks, if default is changed)</p></li>
<li><p>rise-decay symmetry (time_rdsym) - fraction of the period in the rise period</p></li>
<li><p>peak-trough symmetry (time_ptsym) - fraction of the period in the peak period</p></li>
</ul>
<p>Note that a warning appears here because no burst detection parameters are provided. This is
addressed in section #4</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bycycle.features</span> <span class="kn">import</span> <a href="../generated/bycycle.features.compute_features.html#bycycle.features.compute_features" title="bycycle.features.compute_features" class="sphx-glr-backref-module-bycycle-features sphx-glr-backref-type-py-function"><span class="n">compute_features</span></a>
<span class="n">df</span> <span class="o">=</span> <a href="../generated/bycycle.features.compute_features.html#bycycle.features.compute_features" title="bycycle.features.compute_features" class="sphx-glr-backref-module-bycycle-features sphx-glr-backref-type-py-function"><span class="n">compute_features</span></a><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">f_theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/bycycle/features.py:104: UserWarning:
            No burst detection parameters are provided.
            This is very much not recommended.
            Please inspect your data and choose appropriate
            parameters for &quot;burst_detection_kwargs&quot;.
            Default burst detection parameters are likely
            not well suited for your desired application.

  warnings.warn(&#39;&#39;&#39;
   sample_peak  sample_zerox_decay  sample_zerox_rise  sample_last_trough  \
0          615                 663                575                 519
1          819                 882                771                 743
2         1002                1026                937                 914
3         1131                1174               1101                1056
4         1273                1331               1229                1214

   sample_next_trough  period  time_peak  time_trough  volt_peak  volt_trough  \
0                 743     224         88          111      1.195       -1.258
1                 914     171        111          108      0.521       -1.071
2                1056     142         89           55      1.093       -0.483
3                1214     158         73           75      1.791       -1.104
4                1392     178        102           55      1.758       -0.503

   time_decay  time_rise  volt_decay  volt_rise  volt_amp  time_rdsym  \
0         128         96       2.266      2.453    2.3595    0.428571
1          95         76       1.004      1.592    1.2980    0.444444
2          54         88       2.197      1.576    1.8865    0.619718
3          83         75       2.294      2.895    2.5945    0.474684
4         119         59       2.684      2.261    2.4725    0.331461

   time_ptsym  band_amp  amp_fraction  amp_consistency  period_consistency  \
0    0.442211  0.570788      0.423620              NaN                 NaN
1    0.506849  0.355844      0.002567         0.630653            0.763393
2    0.618056  0.686511      0.077022         0.637056            0.830409
3    0.493243  0.680391      0.643132         0.758895            0.887640
4    0.649682  0.654177      0.537869         0.762668            0.691011

   monotonicity  is_burst
0      0.633444     False
1      0.584539     False
2      0.647907     False
3      0.604812     False
4      0.607101     False
</pre></div>
</div>
</div>
<div class="section" id="determine-parts-of-signal-in-oscillatory-burst">
<h2>4. Determine parts of signal in oscillatory burst<a class="headerlink" href="#determine-parts-of-signal-in-oscillatory-burst" title="Permalink to this headline">¶</a></h2>
<p>Note above that the signal is segmented into cycles and the dataframe provides properties for each
segment of the signal. However, if no oscillation is apparent in the signal at a given time, the
properties for these “cycles” are meaningless. Therefore, it is useful to have a binary indicator
for each cycle that indicates whether the cycle being analyzed is truly part of an oscillatory
burst or not. Recently, significant interest has emerged in detecting bursts in signals and
analyzing their properties (see e.g. Feingold et al., PNAS, 2015). Nearly all efforts toward burst
detection relies on amplitude thresholds, but this can be disadvantageous because these algorithms
will behave very differently on signals where oscillations are common versus rare.</p>
<p>In our approach, we employ an alternative technique for burst detection. There are 3 thresholds
that need to be met in order for a cycle to be classified as part of an oscillatory burst.</p>
<ol class="arabic simple">
<li><p>amplitude consistency - consecutive rises and decays should be comparable in magnitude.</p></li>
</ol>
<ul class="simple">
<li><p>The amplitude consistency of a cycle is equal to the maximum relative difference between rises and decay amplitudes across all pairs of adjacent rises and decays that include one of the flanks in the cycle (3 pairs)</p></li>
<li><p>e.g. if a rise is 10mV and a decay is 7mV, then its amplitude consistency is 0.7.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>period consistency - consecutive cycles should be comparable in duration</p></li>
</ol>
<ul class="simple">
<li><p>The period consistency is equal to the maximu relative difference between all pairs of adjacent periods that include the cycle of interest (2 pairs: current + previous cycles and current + next cycles)</p></li>
<li><p>e.g. if the previous, current, and next cycles have periods 60ms, 100ms, and 120ms, respectively, then the period consistency is min(60/100, 100/120) = 0.6.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>monotonicity - the rise and decay flanks of the cycle should be mostly monotonic</p></li>
</ol>
<ul class="simple">
<li><p>The monotonicity is the fraction of samples that the instantaneous derivative (numpy.diff) is consistent with the direction of the flank.</p></li>
<li><p>e.g. if in the rise, the instantaneous derivative is 90% positive, and in the decay, the instantaneous derivative is 80% negative, then the monotonicity of the cycle would be 0.85 ((0.9+0.8)/2)</p></li>
</ul>
<p>Below, we load a simulated signal and then define 3 sets of thresholds ranging from liberal to
conservative.</p>
<div class="section" id="load-a-simulated-signal-and-apply-a-lowpass-filter">
<h3>Load a simulated signal and apply a lowpass filter<a class="headerlink" href="#load-a-simulated-signal-and-apply-a-lowpass-filter" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the signal</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data/sim_bursting.npy&#39;</span><span class="p">)</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling rate</span>
<span class="n">f_alpha</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Apply a lowpass filter to remove high frequency power that interferes with extrema localization</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">lowpass_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">N_seconds</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">remove_edge_artifacts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="visualizing-burst-detection-settings">
<h3>Visualizing burst detection settings<a class="headerlink" href="#visualizing-burst-detection-settings" title="Permalink to this headline">¶</a></h3>
<p>Below, we visualize how the burst detector determined which cycles were part of an oscillatory
burst. The top plot shows a markup of the time series. The portions of the signal in red were
determined to be parts of bursts. Signals in black were not part of bursts. Magenta and cyan dots
denote detected peaks and troughs, respectively. Highlights indicate cycles marked as not part of
a burst because they did not meet certain thresholds:</p>
<ul class="simple">
<li><p>red highlight: amplitude consistency threshold violation</p></li>
<li><p>yellow highlight: period consistency threshold violation</p></li>
<li><p>green highlight: monotonicity threshold violation The plots below show the relevant features for each cycle as well as the threshold (dotted lines), where we can see the highlights appear if the features went below the threshold.</p></li>
</ul>
<p>Note there is an optional “band amplitude fraction” threshold. This is currently unused (set to 0)
, but is present in case users want to add an amplitude threshold to this algorithm.</p>
</div>
<div class="section" id="burst-detection-settings-too-liberal">
<h3>Burst detection settings: too liberal<a class="headerlink" href="#burst-detection-settings-too-liberal" title="Permalink to this headline">¶</a></h3>
<p>The following burst detection thresholds (defined in burst_kwargs) are too low, so some portions
of the signal that do not have much apparent oscillatory burst are still labeled as if they do.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bycycle.burst</span> <span class="kn">import</span> <a href="../generated/bycycle.burst.plot_burst_detect_params.html#bycycle.burst.plot_burst_detect_params" title="bycycle.burst.plot_burst_detect_params" class="sphx-glr-backref-module-bycycle-burst sphx-glr-backref-type-py-function"><span class="n">plot_burst_detect_params</span></a>

<span class="n">burst_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;amplitude_fraction_threshold&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;amplitude_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;period_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">45</span><span class="p">,</span>
                <span class="s1">&#39;monotonicity_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span>
                <span class="s1">&#39;N_cycles_min&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <a href="../generated/bycycle.features.compute_features.html#bycycle.features.compute_features" title="bycycle.features.compute_features" class="sphx-glr-backref-module-bycycle-features sphx-glr-backref-type-py-function"><span class="n">compute_features</span></a><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">f_alpha</span><span class="p">,</span> <span class="n">burst_detection_kwargs</span><span class="o">=</span><span class="n">burst_kwargs</span><span class="p">)</span>

<a href="../generated/bycycle.burst.plot_burst_detect_params.html#bycycle.burst.plot_burst_detect_params" title="bycycle.burst.plot_burst_detect_params" class="sphx-glr-backref-module-bycycle-burst sphx-glr-backref-type-py-function"><span class="n">plot_burst_detect_params</span></a><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">burst_kwargs</span><span class="p">,</span>
                         <span class="n">tlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="plot 2 bycycle algorithm" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_2_bycycle_algorithm_005.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/.env/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3372: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/home/rph/Projects/bycycle/.env/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)

[&lt;Figure size 1200x1500 with 5 Axes&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f66512f06a0&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664ed175e0&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664eb9f220&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f6656e2b3a0&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664e9c26a0&gt;]
</pre></div>
</div>
</div>
<div class="section" id="burst-detection-settings-too-conservative">
<h3>Burst detection settings: too conservative<a class="headerlink" href="#burst-detection-settings-too-conservative" title="Permalink to this headline">¶</a></h3>
<p>These new burst detection thresholds seem to be set too high (too strict) as the algorithm is not
able to detect the bursts that are present.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">burst_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;amplitude_fraction_threshold&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;amplitude_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span>
                <span class="s1">&#39;period_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span>
                <span class="s1">&#39;monotonicity_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span>
                <span class="s1">&#39;N_cycles_min&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <a href="../generated/bycycle.features.compute_features.html#bycycle.features.compute_features" title="bycycle.features.compute_features" class="sphx-glr-backref-module-bycycle-features sphx-glr-backref-type-py-function"><span class="n">compute_features</span></a><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">f_alpha</span><span class="p">,</span> <span class="n">burst_detection_kwargs</span><span class="o">=</span><span class="n">burst_kwargs</span><span class="p">)</span>

<a href="../generated/bycycle.burst.plot_burst_detect_params.html#bycycle.burst.plot_burst_detect_params" title="bycycle.burst.plot_burst_detect_params" class="sphx-glr-backref-module-bycycle-burst sphx-glr-backref-type-py-function"><span class="n">plot_burst_detect_params</span></a><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">burst_kwargs</span><span class="p">,</span>
                         <span class="n">tlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="plot 2 bycycle algorithm" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_2_bycycle_algorithm_006.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/.env/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3372: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/home/rph/Projects/bycycle/.env/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)

[&lt;Figure size 1200x1500 with 5 Axes&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664ec0a640&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664eaea940&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664e905460&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664e9982e0&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664eb95280&gt;]
</pre></div>
</div>
</div>
<div class="section" id="more-appropriate-burst-detection-thresholds">
<h3>More appropriate burst detection thresholds<a class="headerlink" href="#more-appropriate-burst-detection-thresholds" title="Permalink to this headline">¶</a></h3>
<p>The conservative thresholds were then lowered, and we can see now that the algorithms correctly
identifies parts of the 3 bursting periods. Therefore, for a signal with this level of noise, we
expect these parameters to be pretty good.</p>
<p>Notice that adding a small amplitude fraction threshold (e.g. 0.3) helps remove some false
positives that may occur, like that around 1.5 seconds.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">burst_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;amplitude_fraction_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;amplitude_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">4</span><span class="p">,</span>
                <span class="s1">&#39;period_consistency_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;monotonicity_threshold&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span>
                <span class="s1">&#39;N_cycles_min&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <a href="../generated/bycycle.features.compute_features.html#bycycle.features.compute_features" title="bycycle.features.compute_features" class="sphx-glr-backref-module-bycycle-features sphx-glr-backref-type-py-function"><span class="n">compute_features</span></a><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">f_alpha</span><span class="p">,</span> <span class="n">burst_detection_kwargs</span><span class="o">=</span><span class="n">burst_kwargs</span><span class="p">)</span>

<a href="../generated/bycycle.burst.plot_burst_detect_params.html#bycycle.burst.plot_burst_detect_params" title="bycycle.burst.plot_burst_detect_params" class="sphx-glr-backref-module-bycycle-burst sphx-glr-backref-type-py-function"><span class="n">plot_burst_detect_params</span></a><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">burst_kwargs</span><span class="p">,</span>
                         <span class="n">tlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="plot 2 bycycle algorithm" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_2_bycycle_algorithm_007.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/rph/Projects/bycycle/.env/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3372: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/home/rph/Projects/bycycle/.env/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)

[&lt;Figure size 1200x1500 with 5 Axes&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664ecf0640&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664ec7b130&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664ece1b80&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664ece93d0&gt;, &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f664edc5310&gt;]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.500 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-plot-2-bycycle-algorithm-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/038cf1e17c69d46556b38dbfaa9e4add/plot_2_bycycle_algorithm.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_2_bycycle_algorithm.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b1ab5701cb95d7b9cddf74ec3caa6b23/plot_2_bycycle_algorithm.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_2_bycycle_algorithm.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018-2020, VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>